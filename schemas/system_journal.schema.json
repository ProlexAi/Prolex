{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://prolex.ai/schemas/system_journal.schema.json",
  "title": "SystemJournalEntry",
  "description": "Structure d'une entrée du journal système (mémoire centralisée)",
  "type": "object",
  "properties": {
    "entry_id": {
      "type": "string",
      "description": "ID unique de l'entrée (UUID v4)",
      "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$"
    },
    "timestamp": {
      "type": "string",
      "description": "Timestamp ISO 8601",
      "format": "date-time"
    },
    "request_id": {
      "type": "string",
      "description": "ID de la requête associée (lien avec KimmyPayload/ProlexOutput)"
    },
    "user_id": {
      "type": "string",
      "description": "ID de l'utilisateur"
    },
    "event_type": {
      "type": "string",
      "description": "Type d'événement",
      "enum": [
        "user_request",
        "kimmy_output",
        "prolex_output",
        "tool_execution",
        "validation_request",
        "validation_response",
        "error",
        "system_alert"
      ]
    },
    "component": {
      "type": "string",
      "description": "Composant source de l'événement",
      "enum": ["kimmy", "prolex", "opex", "mcp", "system"]
    },
    "severity": {
      "type": "string",
      "description": "Niveau de sévérité",
      "enum": ["debug", "info", "warning", "error", "critical"],
      "default": "info"
    },
    "data": {
      "type": "object",
      "description": "Données de l'événement (structure libre selon event_type)"
    },
    "tags": {
      "type": "array",
      "description": "Tags pour recherche et filtrage",
      "items": {
        "type": "string"
      }
    },
    "correlation_id": {
      "type": "string",
      "description": "ID de corrélation pour regrouper plusieurs entrées liées"
    }
  },
  "required": [
    "entry_id",
    "timestamp",
    "event_type",
    "component",
    "severity"
  ]
}
